<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="ja"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>AutoSelectImpl.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">sqlmapper-spring-boot-autoconfigure</a> &gt; <a href="../index.html" class="el_bundle">sqlmapper-core</a> &gt; <a href="index.source.html" class="el_package">com.github.mygreen.sqlmapper.core.query.auto</a> &gt; <span class="el_source">AutoSelectImpl.java</span></div><h1>AutoSelectImpl.java</h1><pre class="source lang-java linenums">package com.github.mygreen.sqlmapper.core.query.auto;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.HashMap;
import java.util.LinkedHashSet;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.Set;
import java.util.stream.Stream;

import com.github.mygreen.sqlmapper.core.SqlMapperContext;
import com.github.mygreen.sqlmapper.core.dialect.Dialect;
import com.github.mygreen.sqlmapper.core.event.PostSelectEvent;
import com.github.mygreen.sqlmapper.core.meta.EntityMeta;
import com.github.mygreen.sqlmapper.core.meta.PropertyMeta;
import com.github.mygreen.sqlmapper.core.meta.PropertyValueInvoker;
import com.github.mygreen.sqlmapper.core.query.IllegalOperateException;
import com.github.mygreen.sqlmapper.core.query.JoinAssociation;
import com.github.mygreen.sqlmapper.core.query.JoinCondition;
import com.github.mygreen.sqlmapper.core.query.JoinType;
import com.github.mygreen.sqlmapper.core.query.SelectForUpdateType;
import com.github.mygreen.sqlmapper.metamodel.EntityPath;
import com.github.mygreen.sqlmapper.metamodel.OrderSpecifier;
import com.github.mygreen.sqlmapper.metamodel.Predicate;
import com.github.mygreen.sqlmapper.metamodel.PropertyPath;

import lombok.Getter;
import lombok.NonNull;

/**
 * 抽出を行うSQLを自動生成するクエリの実装です。
 *
 * @author T.TSUCHIE
 *
 * @param &lt;T&gt; 処理対象となるエンティティの型
 */
public class AutoSelectImpl&lt;T&gt; implements AutoSelect&lt;T&gt; {

    /**
     * SqlMapperの設定情報。
     */
    @Getter
    private final SqlMapperContext context;

    @Getter
    private final Class&lt;T&gt; baseClass;

    @Getter
    private final EntityPath&lt;T&gt; entityPath;

    @Getter
    private final EntityMeta entityMeta;

    /**
     * エンティティタイプとメタ情報のマップ
     */
<span class="fc" id="L60">    @Getter</span>
    private final Map&lt;Class&lt;?&gt;, EntityMeta&gt; entityMetaMap = new HashMap&lt;&gt;();

    @Getter
    private Integer queryTimeout;

    @Getter
    private Integer fetchSize;

    @Getter
    private Integer maxRows;

    /**
     * SQLのヒントです。
     */
    @Getter
    private String hint;

    /**
     * 取得するレコード数の上限値です。
     * &lt;p&gt;負の値の時は無視します。
     */
<span class="fc" id="L82">    @Getter</span>
    private int limit = -1;

    /**
     * 取得するレコード数の開始位置です。
     * &lt;p&gt;負の値の時は無視します。
     */
<span class="fc" id="L89">    @Getter</span>
    private int offset = -1;

    /**
     * select句へ追加するプロパティです。
     */
<span class="fc" id="L95">    @Getter</span>
    private final Set&lt;PropertyPath&lt;?&gt;&gt; includesProperties = new LinkedHashSet&lt;&gt;();

    /**
     * select句から除外するプロパティです。
     */
<span class="fc" id="L101">    @Getter</span>
    private final Set&lt;PropertyPath&lt;?&gt;&gt; excludesProperties = new LinkedHashSet&lt;&gt;();

    /**
     * テーブルの結合条件の一覧です。
     */
<span class="fc" id="L107">    @SuppressWarnings(&quot;rawtypes&quot;)</span>
    @Getter
    private final List&lt;JoinCondition&gt; joinConditions = new ArrayList&lt;&gt;();

    /**
     * エンティティの構成定義の一覧です
     */
<span class="fc" id="L114">    @SuppressWarnings(&quot;rawtypes&quot;)</span>
    @Getter
    private final List&lt;JoinAssociation&gt; joinAssociations = new ArrayList&lt;&gt;();

    /**
     * 検索条件です。
     */
    @Getter
    private Predicate where;

    /**
     * ソート順です。
     */
<span class="fc" id="L127">    @Getter</span>
    private List&lt;OrderSpecifier&gt; orders = new ArrayList&lt;&gt;();

    /**
     * 検索条件で指定したIDプロパティの値の配列です。
     */
    @Getter
    private Object[] idPropertyValues;

    /**
     * バージョンプロパティの値です。
     */
    @Getter
    private Object versionPropertyValue;

    /**
     * SELECT ～ FOR UPDATEのタイプです。
     */
    @Getter
    private SelectForUpdateType forUpdateType;

    /**
     * SELECT ～ FOR UPDATEでの待機時間 (秒単位) です。
     */
<span class="fc" id="L151">    @Getter</span>
    private int forUpdateWaitSeconds = 0;

    /**
     * {@link AutoSelectImpl}を作成します。
     * @param context SqlMapperの設定情報。
     * @param entityPath マッピングするエンティティのメタモデル。
     */
    @SuppressWarnings(&quot;unchecked&quot;)
<span class="pc bpc" id="L160" title="2 of 4 branches missed.">    public AutoSelectImpl(@NonNull SqlMapperContext context, @NonNull EntityPath&lt;T&gt; entityPath) {</span>
<span class="fc" id="L161">        this.context = context;</span>
<span class="fc" id="L162">        this.entityPath = entityPath;</span>
<span class="fc" id="L163">        this.entityMeta = context.getEntityMetaFactory().create(entityPath.getType());</span>
<span class="fc" id="L164">        this.baseClass = (Class&lt;T&gt;)entityMeta.getEntityType();</span>

<span class="fc" id="L166">        this.entityMetaMap.put(entityPath.getType(), context.getEntityMetaFactory().create(entityPath.getType()));</span>
<span class="fc" id="L167">    }</span>

    @Override
    public AutoSelectImpl&lt;T&gt; queryTimeout(int seconds) {
<span class="nc" id="L171">        this.queryTimeout = seconds;</span>
<span class="nc" id="L172">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; fetchSize(int fetchSize) {
<span class="nc" id="L177">        this.fetchSize = fetchSize;</span>
<span class="nc" id="L178">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; maxRows(int maxRows) {
<span class="nc" id="L183">        this.maxRows = maxRows;</span>
<span class="nc" id="L184">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; hint(String hint) {
<span class="nc" id="L189">        this.hint = hint;</span>
<span class="nc" id="L190">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; limit(int limit) {
<span class="fc" id="L195">        this.limit = limit;</span>
<span class="fc" id="L196">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; offset(int offset) {
<span class="fc" id="L201">        this.offset = offset;</span>
<span class="fc" id="L202">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; includes(final PropertyPath&lt;?&gt;... properties) {

<span class="fc bfc" id="L208" title="All 2 branches covered.">        for(PropertyPath&lt;?&gt; prop : properties) {</span>
<span class="fc" id="L209">            this.includesProperties.add(prop);</span>
        }

<span class="fc" id="L212">        return this;</span>

    }

    @Override
    public AutoSelectImpl&lt;T&gt; excludes(final PropertyPath&lt;?&gt;... properties) {

<span class="fc bfc" id="L219" title="All 2 branches covered.">        for(PropertyPath&lt;?&gt; prop : properties) {</span>
<span class="fc" id="L220">            this.excludesProperties.add(prop);</span>
        }

<span class="fc" id="L223">        return this;</span>

    }

    @Override
<span class="pc bpc" id="L228" title="1 of 2 branches missed.">    public &lt;ENTITY extends EntityPath&lt;?&gt;&gt; AutoSelectImpl&lt;T&gt; innerJoin(@NonNull ENTITY toEntityPath,</span>
<span class="pc bpc" id="L229" title="1 of 2 branches missed.">            @NonNull JoinCondition.Conditioner&lt;ENTITY&gt; conditioner) {</span>

<span class="fc" id="L231">        JoinCondition&lt;ENTITY&gt; condition = new JoinCondition&lt;&gt;(JoinType.INNER, toEntityPath, conditioner);</span>
<span class="fc" id="L232">        validateJoinCondition(condition);</span>

<span class="fc" id="L234">        this.entityMetaMap.put(toEntityPath.getType(), context.getEntityMetaFactory().create(toEntityPath.getType()));</span>
<span class="fc" id="L235">        this.joinConditions.add(condition);</span>
<span class="fc" id="L236">        return this;</span>
    }

    @Override
<span class="pc bpc" id="L240" title="1 of 2 branches missed.">    public &lt;ENTITY extends EntityPath&lt;?&gt;&gt; AutoSelectImpl&lt;T&gt; leftJoin(@NonNull ENTITY toEntityPath,</span>
<span class="pc bpc" id="L241" title="1 of 2 branches missed.">            @NonNull JoinCondition.Conditioner&lt;ENTITY&gt; conditioner) {</span>

<span class="fc" id="L243">        JoinCondition&lt;ENTITY&gt; condition = new JoinCondition&lt;&gt;(JoinType.LEFT_OUTER, toEntityPath, conditioner);</span>
<span class="fc" id="L244">        validateJoinCondition(condition);</span>

<span class="fc" id="L246">        this.entityMetaMap.put(toEntityPath.getType(), context.getEntityMetaFactory().create(toEntityPath.getType()));</span>
<span class="fc" id="L247">        this.joinConditions.add(condition);</span>

<span class="fc" id="L249">        return this;</span>
    }

    /**
     * 結合条件の一覧に既に同じテーブルのエンティティ情報が含まれいえるか検査します。
     * &lt;ul&gt;
     *   &lt;li&gt;比較は、結合先のエンティティ情報({@link EntityPath})既に存在するかどうか。&lt;/li&gt;
     *   &lt;li&gt;結合種別({@link JoinType}) は無視します。&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @param condition 結合条件
     * @return 同じエンティティの組み合わせが含まれているとき {@literal true} を返します
     * @throws IllegalOperateException 既に同じ組み合わせのエンティティ（テーブル）を指定しているときにスローされます。
     */
    private void validateJoinCondition(JoinCondition&lt;?&gt; condition) {

        // 同じ組み合わせのエンティティが存在しかチェックします。
<span class="fc bfc" id="L266" title="All 2 branches covered.">        for(JoinCondition&lt;?&gt; target : joinConditions) {</span>
<span class="pc bpc" id="L267" title="1 of 2 branches missed.">            if(target.getToEntity().equals(condition.getToEntity())) {</span>

                // 同じ組み合わせの場合
<span class="nc" id="L270">                throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.existsSameJoinEntity&quot;)</span>
<span class="nc" id="L271">                        .param(&quot;toEntity&quot;, condition.getToEntity().getPathMeta().getElement())</span>
<span class="nc" id="L272">                        .format());</span>
            }
<span class="fc" id="L274">        }</span>

<span class="fc" id="L276">    }</span>

    @Override
<span class="pc bpc" id="L279" title="2 of 4 branches missed.">    public &lt;E1, E2&gt; AutoSelectImpl&lt;T&gt; associate(@NonNull EntityPath&lt;E1&gt; entityPath1, @NonNull EntityPath&lt;E2&gt; entityPath2,</span>
<span class="pc bpc" id="L280" title="1 of 2 branches missed.">            @NonNull JoinAssociation.Associator&lt;E1, E2&gt; associator) {</span>

<span class="fc" id="L282">        JoinAssociation&lt;E1, E2&gt; association = new JoinAssociation&lt;&gt;(entityPath1, entityPath2, associator);</span>

        // 同じ組み合わせのエンティティが存在しないかチェックします
<span class="fc bfc" id="L285" title="All 2 branches covered.">        for(JoinAssociation&lt;?, ?&gt; target : joinAssociations) {</span>
<span class="pc bpc" id="L286" title="3 of 4 branches missed.">            if((target.getEntity1().equals(association.getEntity1()) &amp;&amp; target.getEntity2().equals(association.getEntity2()))</span>
<span class="pc bpc" id="L287" title="3 of 4 branches missed.">                    || (target.getEntity1().equals(association.getEntity2()) &amp;&amp; target.getEntity2().equals(association.getEntity1()))</span>
                    ) {
                // 同じ組み合わせの場合 - エンティティ1、エンティティ2の順番は考慮しません。
<span class="nc" id="L290">                throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.existsSameAssociateEntity&quot;)</span>
<span class="nc" id="L291">                        .param(&quot;entity1&quot;, association.getEntity1().getPathMeta().getElement())</span>
<span class="nc" id="L292">                        .param(&quot;entity2&quot;, association.getEntity2().getPathMeta().getElement())</span>
<span class="nc" id="L293">                        .format());</span>
            }
<span class="fc" id="L295">        }</span>

<span class="fc" id="L297">        this.joinAssociations.add(association);</span>
<span class="fc" id="L298">        return this;</span>
    }

    @Override
<span class="pc bpc" id="L302" title="1 of 2 branches missed.">    public AutoSelectImpl&lt;T&gt; where(@NonNull Predicate where) {</span>
<span class="fc" id="L303">        this.where = where;</span>
<span class="fc" id="L304">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; orderBy(OrderSpecifier... orders) {
        //TODO: 追加ではなく、上書き（直接変数に代入）する
<span class="fc" id="L310">        this.orders.addAll(Arrays.asList(orders));</span>
<span class="fc" id="L311">        return this;</span>
    }

    @Override
<span class="pc bpc" id="L315" title="1 of 2 branches missed.">    public AutoSelectImpl&lt;T&gt; id(@NonNull final Object... idPropertyValues) {</span>

<span class="fc" id="L317">        Optional&lt;PropertyMeta&gt; embeddedIdPropertyMeta = entityMeta.getEmbeddedIdPropertyMeta();</span>
<span class="fc bfc" id="L318" title="All 2 branches covered.">        if(isEmbeddedProperty(idPropertyValues, embeddedIdPropertyMeta)) {</span>
            // 埋め込みIDのとき
<span class="fc" id="L320">            this.idPropertyValues = getEmbeddedIdValue(idPropertyValues[0], embeddedIdPropertyMeta.get().getEmbeddedablePopertyMetaList());</span>
        } else {
<span class="fc" id="L322">            List&lt;PropertyMeta&gt; idPropertyMetaList = entityMeta.getIdPropertyMetaList();</span>
<span class="pc bpc" id="L323" title="1 of 2 branches missed.">            if(idPropertyMetaList.size() != idPropertyValues.length) {</span>
<span class="nc" id="L324">                throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.noMatchIdPropertySize&quot;)</span>
<span class="nc" id="L325">                        .paramWithClass(&quot;entityType&quot;, entityPath.getType())</span>
<span class="nc" id="L326">                        .param(&quot;actualSize&quot;, idPropertyValues.length)</span>
<span class="nc" id="L327">                        .param(&quot;expectedSize&quot;, idPropertyMetaList.size())</span>
<span class="nc" id="L328">                        .format());</span>
            }

<span class="fc" id="L331">            this.idPropertyValues = idPropertyValues;</span>
        }

<span class="fc" id="L334">        return this;</span>
    }

    /**
     * IDのクラスタイプが埋め込みIDであるかどうか。
     * @param idPropertyValues 判定対象の値
     * @param embeddedIdPropertyMeta 埋め込みIDのメタ情報
     * @return {@literal true}のとき埋め込みID。
     */
    private boolean isEmbeddedProperty(Object[] idPropertyValues, Optional&lt;PropertyMeta&gt; embeddedIdPropertyMeta) {
<span class="pc bpc" id="L344" title="1 of 4 branches missed.">        if(idPropertyValues.length == 0 || embeddedIdPropertyMeta.isEmpty()) {</span>
<span class="fc" id="L345">            return false;</span>
<span class="fc bfc" id="L346" title="All 2 branches covered.">        } else if(idPropertyValues.length &gt;= 2) {</span>
            // IDの指定件数が複数ある時点で埋め込みIDではないので対象外とする。
<span class="fc" id="L348">            return false;</span>
        }

<span class="fc" id="L351">        Class&lt;?&gt; embeddedType = embeddedIdPropertyMeta.get().getPropertyType();</span>
<span class="fc" id="L352">        return embeddedType.isAssignableFrom(idPropertyValues[0].getClass());</span>
    }

    /**
     * 埋め込みIDの各プロパティの値を取得する。
     * @param value 埋め込みIDのインスタンス
     * @param embeddablePropertyList 埋め込みIDのプロパティのメタ情報
     * @return 埋め込みIDのプロパティの値
     */
    private Object[] getEmbeddedIdValue(Object value, Collection&lt;PropertyMeta&gt; embeddablePropertyList) {

<span class="fc" id="L363">        List&lt;Object&gt; idValueList = new ArrayList&lt;&gt;(embeddablePropertyList.size());</span>
<span class="fc bfc" id="L364" title="All 2 branches covered.">        for(PropertyMeta propertyMeta : embeddablePropertyList) {</span>
<span class="fc" id="L365">            idValueList.add(PropertyValueInvoker.getPropertyValue(propertyMeta, value));</span>
<span class="fc" id="L366">        }</span>

<span class="fc" id="L368">        return idValueList.toArray(new Object[idValueList.size()]);</span>
    }

    @Override
<span class="pc bpc" id="L372" title="1 of 2 branches missed.">    public AutoSelectImpl&lt;T&gt; version(@NonNull final Object versionPropertyValue) {</span>

<span class="pc bpc" id="L374" title="1 of 2 branches missed.">        if(!entityMeta.hasVersionPropertyMeta()) {</span>
<span class="nc" id="L375">            throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.noVersionProperty&quot;)</span>
<span class="nc" id="L376">                    .paramWithClass(&quot;entityType&quot;, entityPath.getType())</span>
<span class="nc" id="L377">                    .format());</span>
        }

<span class="fc" id="L380">        this.versionPropertyValue = versionPropertyValue;</span>

<span class="fc" id="L382">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; forUpdate() {
<span class="nc" id="L387">        final Dialect dialect = context.getDialect();</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">        if(!dialect.supportsSelectForUpdate(SelectForUpdateType.NORMAL)) {</span>
<span class="nc" id="L389">            throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.notSupportSelectForUpdate&quot;)</span>
<span class="nc" id="L390">                    .paramWithClass(&quot;entityType&quot;, entityPath.getType())</span>
<span class="nc" id="L391">                    .param(&quot;dialectName&quot;, dialect.getName())</span>
<span class="nc" id="L392">                    .format());</span>
        }

<span class="nc" id="L395">        this.forUpdateType = SelectForUpdateType.NORMAL;</span>
<span class="nc" id="L396">        return this;</span>
    }

    @Override
    public AutoSelectImpl&lt;T&gt; forUpdateNoWait() {

<span class="nc" id="L402">        final Dialect dialect = context.getDialect();</span>
<span class="nc bnc" id="L403" title="All 2 branches missed.">        if(!dialect.supportsSelectForUpdate(SelectForUpdateType.NOWAIT)) {</span>
<span class="nc" id="L404">            throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.notSupportSelectForUpdateNowait&quot;)</span>
<span class="nc" id="L405">                    .paramWithClass(&quot;entityType&quot;, entityPath.getType())</span>
<span class="nc" id="L406">                    .param(&quot;dialectName&quot;, dialect.getName())</span>
<span class="nc" id="L407">                    .format());</span>
        }

<span class="nc" id="L410">        this.forUpdateType = SelectForUpdateType.NOWAIT;</span>
<span class="nc" id="L411">        return this;</span>
    }

    /**
     * {@literal FOR UPDATE WAIT} を追加します。
     * @param seconds  ロックを獲得できるまでの最大待機時間(秒単位)
     * @return このインスタンス自身。
     * @throws IllegalOperateException DBMSがこの操作をサポートしていない場合にスローされます。
     */
    public AutoSelectImpl&lt;T&gt; forUpdateWait(final int seconds) {

<span class="nc" id="L422">        final Dialect dialect = context.getDialect();</span>
<span class="nc bnc" id="L423" title="All 2 branches missed.">        if(!dialect.supportsSelectForUpdate(SelectForUpdateType.WAIT)) {</span>
<span class="nc" id="L424">            throw new IllegalOperateException(context.getMessageFormatter().create(&quot;query.notSupportSelectForUpdateWait&quot;)</span>
<span class="nc" id="L425">                    .paramWithClass(&quot;entityType&quot;, entityPath.getType())</span>
<span class="nc" id="L426">                    .param(&quot;dialectName&quot;, dialect.getName())</span>
<span class="nc" id="L427">                    .format());</span>
        }

<span class="nc" id="L430">        this.forUpdateType = SelectForUpdateType.WAIT;</span>
<span class="nc" id="L431">        this.forUpdateWaitSeconds = seconds;</span>
<span class="nc" id="L432">        return this;</span>
    }

    @Override
    public long getCount() {
<span class="fc" id="L437">        return new AutoSelectExecutor&lt;&gt;(this, true)</span>
<span class="fc" id="L438">                .getCount();</span>
    }

    @Override
    public T getSingleResult() {
<span class="fc" id="L443">        return  new AutoSelectExecutor&lt;&gt;(this, false)</span>
<span class="fc" id="L444">                .getSingleResult(entity -&gt; {</span>
<span class="fc" id="L445">                    context.getApplicationEventPublisher().publishEvent(new PostSelectEvent(AutoSelectImpl.this, entityMeta, entity));</span>
<span class="fc" id="L446">                });</span>
    }

    @Override
    public Optional&lt;T&gt; getOptionalResult() {
<span class="fc" id="L451">        return new AutoSelectExecutor&lt;&gt;(this, false)</span>
<span class="fc" id="L452">                .getOptionalResult(entity -&gt; {</span>
<span class="fc" id="L453">                    context.getApplicationEventPublisher().publishEvent(new PostSelectEvent(AutoSelectImpl.this, entityMeta, entity));</span>
<span class="fc" id="L454">                });</span>
    }

    @Override
    public List&lt;T&gt; getResultList() {
<span class="fc" id="L459">        return new AutoSelectExecutor&lt;&gt;(this, false)</span>
<span class="fc" id="L460">                .getResultList(entity -&gt; {</span>
<span class="fc" id="L461">                    context.getApplicationEventPublisher().publishEvent(new PostSelectEvent(AutoSelectImpl.this, entityMeta, entity));</span>
<span class="fc" id="L462">                });</span>
    }

    @Override
    public Stream&lt;T&gt; getResultStream() {
<span class="fc" id="L467">        return new AutoSelectExecutor&lt;&gt;(this, false)</span>
<span class="fc" id="L468">                .getResultStream(entity -&gt; {</span>
<span class="fc" id="L469">                    context.getApplicationEventPublisher().publishEvent(new PostSelectEvent(AutoSelectImpl.this, entityMeta, entity));</span>
<span class="fc" id="L470">                });</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>